var ws = null
var url = "ws://merchant.qless.com:8000"
self.addEventListener("connect", function(e) {
	var port = e.ports[0]
	port.addEventListener("message", function(e) {
		if (e.data === "start") {
			if (ws === null) {
				console.log('entro en el ws');
				port.postMessage('Hola mundo!');
				ws = new WebSocket(url);
				port.postMessage("started connection to " + url);
				const cookie = "AU: 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";
				console.log(cookie);
				ws.send('Module: ConsumerEventModule');
console.log('module send')
				ws.send(cookie);
console.log('cookie send')
				ws.send('PAGE: 129783608561230561050795617056');
console.log('page send')
			} else {
				port.postMessage("reusing connection to " + url);
			}
		}
	}, false);
	port.start();
}, false);
